<?php 
/**
 * Template for index action
 * 
 * @category   OntoWiki
 * @package    OntoWiki_extensions_patapro
 * @author     Lars Eidam <larseidam@googlemail.com>
 * @author     Konrad Abicht <konrad@inspirito.de>
 * @copyright  Copyright (c) 2011
 * @license    http://opensource.org/licenses/gpl-license.php GNU General Public License (GPL)
 */
?>
<form method="post" action="" id="patapro">
    <table>
        <tr>
            <th><div>Patients</div></th>
            <?php if ("" != $this->currentPatient) { ?>
                <th><div>Healthstate</div></th>
                <th><div>Proposals</div></th>
            <?php } ?>
        </tr>
        <tr>
            <td id="patientCol">
                <?php foreach ($this->patients as $patient) { ?>
                    <?php
                        $patientCss = '';
                        if ($patient ['uri'] == $this->currentPatient)
                            $patientCss = 'patientSelected';
		    ?>
                    <div class="patient <?php echo $patientCss; ?>">
                        <a href="<?php echo $this->url . '?patientUri=' . $patient['uri']; ?>">
                            <?php echo $patient['firstName'] . ' ' . $patient['lastName']; ?>
                        </a>
                    </div>
                <?php } ?>
            </td>
            <?php if ("" != $this->currentPatient) { ?>
                <td id="healthstateCol">
                    <div id="healthstate">
                        <?php foreach ($this->options as $topicLabel => $topic) { ?>
                            <div class="topic"><?php echo $topicLabel; ?></div>
                            <?php foreach ($topic as $option) { ?>
                                
                            <div class="option"><?php echo $option['optionLabel']; ?></div>
                            
                            <?php } ?>
                        <?php } ?>
                    </div>
                </td>
                <td id="proposalCol">
                    <?php foreach ($this->proposals as $proposalUri => $proposal) { ?> 
                    <div class="proposal">
                        <input type="checkbox" name="<?php echo $proposalUri; ?>" value="selectedOption" <?php echo (isset($proposal['checked']) ? "checked=\"checked\"" : ""); ?>>
                        <span><?php echo $proposal['label']; ?></span>
                    </div>
                    <?php } ?>
                </td>
            <?php } ?>
        </tr>
    </table>
    
    <input type="hidden" name="do" value="save"/>
    
    <?php if ("" != $this->currentPatient) { ?>
        <div id="formButtons"><a id="addResource" class="button submit" onclick="document.forms['patapro'].submit();"/></span>
            <?php echo $this->_translate->_('Save'); ?></a>
    <?php } ?>
</form>
